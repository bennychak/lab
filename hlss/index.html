<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<title>Lunch Select System</title>
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<meta name="format-detection" content="telephone=no" />
<meta name="viewport" content="width=device-width, initial-scale=0.5, minimum-scale=0.5, maximum-scale=0.5, user-scalable=no" />
<link rel="shortcut icon" href="http://mat1.gtimg.com/www/mb/favicon.ico"/>
<link rel="apple-touch-icon-precomposed" sizes="57x57" href="http://mat1.gtimg.com/www/mb/images/read/hlss57.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://mat1.gtimg.com/www/mb/images/read/hlss72.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://mat1.gtimg.com/www/mb/images/read/hlss114.png" />

<link rel="apple-touch-startup-image" href="http://mat1.gtimg.com/www/mb/images/read/hlss_startup.png" />
<link rel="apple-touch-startup-image" sizes="640x920" href="http://mat1.gtimg.com/www/mb/images/read/hlss_startup_retina.png" />
<link rel="apple-touch-startup-image" sizes="320x460" href="http://mat1.gtimg.com/www/mb/images/read/hlss_startup.png" media="screen and (max-device-width: 320)" />
<link rel="stylesheet" href="http://mat1.gtimg.com/joke/mobile/jquery.mobile-1.2.0.min.css" />
<style type="text/css">
@import url("../../css/lab/hlss/style.css");
</style>
<script type="text/javascript" src="http://mat1.gtimg.com/joke/mobile/jquery.js"></script>
<script type="text/javascript" src="http://mat1.gtimg.com/joke/mobile/jquery.mobile-1.2.0.min.js"></script>
<script type="text/javascript">
$(function(){
	randomitem();
	$('#active').toggle(function(){
		$('.m').removeClass('f1 f2 f3').addClass('f2');
		},function(){
			$('.m').removeClass('f1 f2 f3').addClass('f1');
			});
	$('#bt_toggleall').toggle(function(){
		$('.m').removeClass('f1 f2').addClass('f3');
		$('.s',this).text('Expand');
		},function(){
			$('.m').removeClass('f1 f2 f3');
			$('.s',this).text('Shrink');
			}).click(function(){
				$('#result').hide();
				});
	$('.direction').tap(function(){
		var d = $(this).attr('id');
		$('.m').find('.ac').removeClass('ac');
		$('.'+d+' .r').addClass('ac');
		$('.direction').attr('disabled',true);
		$('#bt_count').attr('disabled',false);
		$('#panel').show();
		});
	$('#bt_randomitem').click(function(){
		randomitem();
		rmflight();
		});
	
	// jQuery Mobile
	$('#bt_intro').tap(function(){
		restart();
		notice();
	});
	$('#bt_num').tap(function(){
		num();
	});
	$('#bt_count').click(function(){
		count();
	});
	$('#bt_return').tap(function(){
		restart();
	});

	});

function randomitem(){
	var items = [
	'Xiang_Kui',
	'Xiang_Kui',
	'Mian_Xiang',
	'Mian_Xiang',
	'Big_Era',
	'Third_Pole',
	'Fang_Yuan',
	'Ma_Hua',
	'Nothing!'
	];
	items.sort(randomsort);
	for(i=0;i<items.length;i++){
		$('.c .t:eq('+i+')').text(items[i]);
		}
	}
function randomsort(a, b) {
	return Math.random()>.5 ? -1 : 1;//用Math.random()函数生成0~1之间的随机数与0.5比较，返回-1或1
}
function restart(){
	$('.m').removeClass('f1 f2').addClass('f3').find('.ac').removeClass('ac');
	$('.direction').attr('disabled',false);
	$('#bt_num').attr('count',1);
	$('#cur').addClass('t').text('Fold');
	$('#bt_count').attr('disabled',true);
	$('.wshade,#active,.return,.start,.showall,.random,#result').hide();
	$('#shade').addClass('cross');
	rmflight();
	}
function num(){
	$('#cur').removeClass('t');
	$('#shade').addClass('cross');
	$('.m').removeClass('f1 f2').addClass('f3');
	var a = $('#cur').text();
	if(a == 'Fold'){
		a = 0;
		}
	a++;
	if(a>0){
		$('.showall,.random').hide();
		$('.return,.start').show();
		}
	$('#cur').text('+'+a);
	$('#result').hide();
	rmflight();
	}
function count(){
	$('#shade').removeClass('cross').addClass('cover');
	var t3 = parseInt($('#cur').text())-1;
	$('.return,.start,.showall,.random').hide();
	if(t3<0){
		result();
		$('.start').hide();
		$('#cur').addClass('t').text('Fold')
		$('.return,.showall,.random').show();
		$('#shade').removeClass('cover');
		return false;
		}
	var t = setTimeout(count,300);
	$('#cur').text(t3);
	$('.rice,.stick').show();
	$('#active').trigger('click');
	}
function result(){
	var dir = $('.ac .t').parents('.d').attr('class').slice(-2);
	var f = $('.m').attr('class').slice(-2);
	var result = $('.'+dir+'d .'+f+'f .t').text();
	$('.'+dir+'d .'+f+'f .t').addClass('flight');
	if(result.slice(-1) == '!'){
		$('.rice,.stick').hide();
		}
	$('#result .h1 span').text(result);
	$('.visit').attr('href','http://t.qq.com/k/'+result).attr('title',result);
	$('#result').show();
	$('body').bind('click',function(){
		$('#result').hide();
		});
	}
function go(){
	$('#result').hide();
	}
function rmflight(){
	$('.ti').find('.flight').removeClass('flight');
	}
function notice(){
	$('.m .d').find('.r').addClass('ac');
	}
</script>
</head>

<body>
<div id="shade"></div>
<div id="result" style="display:none">
<div class="alert">
<a href="###" target="_blank" class="bowl visit">
<span class="stick">
<i><i></i></i>
</span>
<span class="ricew">
<span class="rice"><i><i><i><i><i><i></i></i></i></i></i></i></span>
</span>
<span class="leftb"></span>
<span class="rightb"></span>
<span class="orn"></span>
</a>
<a href="###" target="_blank" class="alin visit">
<span class="h1 kai"><span></span></span>
</a>
</div>
</div>
<div class="wshade" id="intro">
<div>
<div class="btw"><span id="bt_intro" class="bt intro"><span class="s t" title="Lunch Select System">Discover</span></span></div>
</div>
</div>
<div class="wshade cross" id="panel" style="display:none">
<div class="btw">
<span id="bt_num" class="bt count"><span class="s" id="cur"></span></span>
<span id="bt_count" class="bt start" style="display:none" title="Okay"><span class="s t">Okay</span></span>
<span id="bt_return" class="bt return" style="display:none" title="Reselect"><span class="s t">Reselect</span></span>
<span id="bt_toggleall" class="bt showall" style="display:none" title="Shrink"><span class="s t">Shrink</span></span>
<span id="bt_randomitem" class="bt random" style="display:none" title="Disturb"><span class="s t">Disturb</span></span>
</div>
</div>
<div class="w">
<div class="control" id="active">
<div class="copyright"><div class="inner">Lunch Select System<br />&copy;2013, Benny Chia, "<a href="mailto:bienfantaisie@gmail.com">bienfantaisie@gmail.com</a>", WDC, Tencent Inc.</div></div>
</div>
<div class="m f3">
<div class="d d1"><div class="r"><div class="shade direction" id="d1"></div><div class="t">E</div></div></div>
<div class="d d2"><div class="r"><div class="shade direction" id="d2"></div><div class="t">S</div></div></div>
<div class="d d3"><div class="r"><div class="shade direction" id="d3"></div><div class="t">W</div></div></div>
<div class="d d4"><div class="r"><div class="shade direction" id="d4"></div><div class="t">N</div></div></div>
<div class="lw">
<div class="l"><div class="l"></div></div>
</div>
<div class="tw">
<div class="c1">
<div class="ci1 c d2d"><div class="tr f1f"><div class="ti"><div class="shade"></div><div class="t"></div></div></div></div>
<div class="ci2 c d3d"><div class="tr f2f"><div class="ti"><div class="shade"></div><div class="t"></div></div></div></div>
<div class="ci3 c d4d"><div class="tr f1f"><div class="ti"><div class="shade"></div><div class="t"></div></div></div></div>
<div class="ci4 c d1d"><div class="tr f2f"><div class="ti"><div class="shade"></div><div class="t"></div></div></div></div>
</div>
<div class="c2">
<div class="ci1 c d1d"><div class="tr f1f"><div class="ti"><div class="shade"></div><div class="t"></div></div></div></div>
<div class="ci2 c d2d"><div class="tr f2f"><div class="ti"><div class="shade"></div><div class="t"></div></div></div></div>
<div class="ci3 c d3d"><div class="tr f1f"><div class="ti"><div class="shade"></div><div class="t"></div></div></div></div>
<div class="ci4 c d4d"><div class="tr f2f"><div class="ti"><div class="shade"></div><div class="t"></div></div></div></div>
</div>
</div>
</div>
<div class="sh">
<div class="shi"></div>
</div>
</div>
</body>
</html>